# DocuSplitter - 文档分割与分析工具

## 项目简介

DocuSplitter 是一个基于 Python 和 Tkinter 的现代化桌面应用程序，提供专业的文档分割和分析功能。该工具支持多种文档格式，具备智能章节识别、批量处理和丰富的用户交互功能，适用于需要高效处理大量文档的场景。

## 核心功能

### 📄 文档分割

**支持的分割模式：**
- **按字符数分割**：将文档按照指定的字符数进行分割
- **按页数分割**：将 PDF 文档按照指定的页数进行分割
- **均分模式**：将文档均匀分割为指定份数

**支持的文件格式：**
- **PDF**（.pdf）：按页数、按字符数、均分
- **Word 文档**（.docx）：按字符数、均分
- **纯文本**（.txt）：按字符数、均分
- **Markdown**（.md）：按字符数、均分

**高级特性：**
- **章节完整性保护**：智能识别章节标题，避免在章节中间分割
- **批量目录导入**：一键选择整个目录，自动加载所有支持的文件
- **拖拽文件支持**：直接拖拽文件到窗口即可加载
- **多文件管理**：支持选择文件、增加文件、清除文件

### 📚 文档合并

**合并功能：**
- **多文件批量合并**：同时合并多个相同格式的文档
- **书签保留**：PDF 合并时自动保留原始书签结构
- **智能文件名生成**：自动生成带时间戳的合并文件名

**支持的文件格式：**
- **PDF**（.pdf）：合并多个 PDF 文件，保留书签
- **Word 文档**（.docx）：合并多个 Word 文件
- **纯文本**（.txt）：合并多个文本文件
- **Markdown**（.md）：合并多个 Markdown 文件

**使用方式：**
- 选择至少两个相同格式的文件
- 点击"合并文件"按钮
- 查看操作日志和生成的合并文件

### 📊 文档分析

**分析功能：**
- **多文件批量分析**：同时分析多个文档
- **详细信息提取**：
  - 文件名
  - 文件类型
  - 字符总数
  - 页数（PDF 和 Word）
  - 文件大小
- **表格展示**：清晰的表格形式呈现分析结果
- **列排序**：点击列标题可按该列排序
- **单例窗口**：确保同时只打开一个分析窗口

### 🎨 用户界面

**现代化设计：**
- **紧凑布局**：450px 固定宽度，适合各种屏幕
- **功能分组**：清晰的视觉层级，操作直观
- **动态显示**：根据选择的分割模式动态显示对应参数
- **可折叠面板**：
  - 高级选项（章节完整性）可折叠
  - 操作日志可折叠
- **右键菜单**：日志区域支持全选、复制、粘贴、清除

**交互优化：**
- **拖拽区域**：醒目的文件拖拽区域
- **按钮分组**：选择文件、增加文件、选择目录、清除文件
- **实时反馈**：进度条、状态提示、操作日志
- **配置保存**：自动保存和加载用户设置

## 系统要求

- **操作系统**：Windows 10/11
- **Python 版本**：3.8+
- **依赖库**：见下方依赖说明

## 依赖库

| 库名 | 版本 | 用途 |
|------|------|------|
| PyPDF2 | 3.0.1 | PDF 文件处理 |
| pypdf | >=3.0.0 | PDF 文件处理（PyPDF2 的继任者，推荐使用） |
| python-docx | 0.8.11 | Word 文档处理 |
| tkinterdnd2 | 0.4.3 | 拖拽功能支持 |
| tqdm | >=4.65.0 | 构建过程中的进度显示 |

**注意**：tkinter 是 Python 内置库，无需单独安装。

## 安装说明

### 1. 克隆项目

```bash
git clone https://github.com/jiedi720/DocuSplitter.git
cd DocuSplitter
```

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

### 3. 运行程序

```bash
python DocuSplitter.py
```

## 使用指南

### 文档分割流程

1. **选择文件**
   - 点击"选择文件"按钮选择单个文件（清除之前的选择）
   - 点击"增加文件"按钮添加更多文件
   - 点击"选择目录"按钮批量导入整个目录的文件
   - 或直接拖拽文件到窗口顶部区域

2. **配置分割参数**
   - 选择分割模式：
     - **按字数**：输入每份文件的字符数
     - **按页数**：输入每份文件的页数（仅 PDF）
     - **均分**：输入要分割的份数
   - 可选：勾选"保留章节完整性"以避免在章节中间分割
   - 设置输出路径（默认为原文件所在目录）

3. **执行分割**
   - 点击"开始分割"按钮
   - 查看进度条和操作日志
   - 如需取消，点击"取消"按钮
   - 分割完成后查看生成的文件列表

### 文档合并流程

1. **选择文件**
   - 选择至少两个相同格式的文档文件
   - 支持使用"增加文件"按钮添加多个文件
   - 支持使用"选择目录"按钮批量导入

2. **执行合并**
   - 点击"合并文件"按钮
   - 查看进度条和操作日志
   - 如需取消，点击"取消"按钮
   - 合并完成后查看生成的文件路径

### 文档分析流程

1. **选择文件**
   - 选择单个或多个文档文件
   - 支持批量选择

2. **开始分析**
   - 点击"分析文档"按钮
   - 等待分析完成

3. **查看结果**
   - 分析结果以表格形式展示
   - 可点击列标题进行排序
   - 点击"关闭"按钮退出

### 按钮功能说明

| 按钮 | 功能 |
|------|------|
| 选择文件 | 选择新文件，清除之前的选择 |
| 增加文件 | 在当前选择基础上添加更多文件 |
| 选择目录 | 批量导入整个目录的所有支持的文件 |
| 清除文件 | 清除所有已选文件 |
| 开始分割 | 开始文档分割操作 |
| 合并文件 | 合并选中的多个相同格式的文件 |
| 分析文档 | 分析选中的文档 |
| 取消 | 取消当前正在进行的操作 |

## 项目结构

```
DocuSplitter/
├── DocuSplitter.py              # 主入口文件
├── requirements.txt             # 项目依赖
├── README.md                   # 项目说明
├── build_exe.py                # 打包脚本
├── DocuSplitter.spec           # PyInstaller 配置
├── DocuSplitter.ini             # 配置文件
├── icons/                      # 图标目录
│   └── DocuSplitter.png        # 应用程序图标
├── function/                   # 功能模块
│   ├── __init__.py
│   ├── file_handler.py         # 通用文件处理
│   ├── pdf_splitter.py         # PDF 分割逻辑
│   ├── pdf_merge.py            # PDF 合并逻辑
│   ├── word_splitter.py        # Word 分割逻辑
│   ├── txt_splitter.py         # TXT 分割逻辑
│   ├── md_splitter.py          # Markdown 分割逻辑
│   ├── document_analyzer.py    # 文档分析工具
│   └── config.py               # 配置管理
├── gui/                        # 图形界面模块
│   ├── __init__.py
│   ├── main_window.py          # 主窗口
│   ├── file_selector.py        # 文件选择组件
│   ├── settings_panel.py       # 设置面板
│   └── analysis_result_window.py # 分析结果窗口
└── GitSync/                    # Git 同步脚本
    ├── Update2Git.bat          # 更新到 Git 脚本
    ├── CloneFromGit.bat        # 从 Git 克隆脚本
    └── ClearFolder.bat         # 清理文件夹脚本
```

## 技术特点

### 架构设计
- **模块化设计**：功能模块与界面模块分离，便于维护和扩展
- **MVC 模式**：清晰的模型-视图-控制器分离
- **单例模式**：确保分析窗口唯一性

### 性能优化
- **多线程处理**：分割操作在后台线程执行，避免界面冻结
- **智能缓存**：章节识别结果缓存，提升性能
- **批量处理**：支持批量文件操作

### 用户体验
- **智能提示**：操作日志实时反馈
- **错误处理**：完善的异常捕获和用户提示
- **配置持久化**：自动保存用户设置
- **响应式设计**：界面元素自适应内容

## 章节识别规则

程序支持多种章节标题格式：

**中文章节：**
- 第X章、第X节、第X篇
- 一、二、三...（中文数字序号）
- 1.、2.、3...（阿拉伯数字序号）
- 1.1、1.1.1、2.3.4...（多级序号）

**英文章节：**
- Chapter X、Section X、Part X
- 1.、2.、3...（阿拉伯数字序号）
- 1.1、1.1.1...（多级序号）

## 配置文件

程序使用 `DocuSplitter.ini` 配置文件保存用户设置：

```ini
[SplitSettings]
mode = chars
chars_value = 1000
pages_value = 10
equal_value = 5
exclude_formats =

[Paths]
input_dir = C:\Users\YourName\Documents
output_dir = C:\Users\YourName\Documents
```

## 打包发布

使用 PyInstaller 打包为可执行文件：

```bash
python build_exe.py
```

打包后的可执行文件位于 `dist/` 目录。

## 常见问题

**Q: 为什么拖拽文件没有反应？**
A: 确保已安装 tkinterdnd2 库：`pip install tkinterdnd2`

**Q: 支持哪些文件格式？**
A: 目前支持 PDF (.pdf)、Word (.docx)、纯文本 (.txt) 和 Markdown (.md) 格式。

**Q: 如何保留章节完整性？**
A: 在分割设置中勾选"高级选项"下的"保留章节完整性"即可。

**Q: 可以批量处理多个文件吗？**
A: 可以使用"选择目录"功能批量导入整个目录的文件，或使用"增加文件"逐个添加。

## 扩展开发

### 添加新的文件格式支持

1. 在 `function/` 目录下创建新的分割器类
2. 继承相应基类并实现分割逻辑
3. 在 `function/__init__.py` 中导出
4. 在 `gui/main_window.py` 中集成

### 添加新的分割模式

1. 在相应的分割器类中添加新方法
2. 在 `gui/settings_panel.py` 中添加对应的 UI 控件
3. 在 `gui/main_window.py` 中添加处理逻辑

## 许可证

MIT License

## 致谢

感谢所有为这个项目做出贡献的开发者！

## 更新日志

### v1.1.0 (2026-01-29)
- ✨ 添加了 Markdown (.md) 文件格式支持
- 📚 增强了文档合并功能，支持所有格式的文件合并
- 📊 改进了文档分析功能，支持批量分析
- 🔧 优化了 PDF 合并时的书签处理
- 📦 更新了依赖库，添加了 pypdf 和 tqdm
- 🎨 改进了用户界面，添加了图标
- 📝 更新了文档，修复了乱码问题
- 🔄 添加了 Git 同步脚本

### v1.0.0 (2026-01-21)
- ✨ 初始版本发布
- 📄 支持 PDF、Word、TXT 文档分割
- 📊 支持文档分析功能
- 🎨 现代化 UI 设计
- 🔄 支持拖拽文件
- 📁 支持批量目录导入
- 📖 章节完整性保护
- ⚙️ 配置保存与加载
- 📝 操作日志记录