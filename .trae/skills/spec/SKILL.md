---
name: "spec"
description: "根据 GifMaker.spec 的配置逻辑重写本程序的 .spec 文件，确保生成的 .exe 文件标题栏正常显示图标，且程序运行后能准确识别并读取同级目录下的配置文件。"
---

# Spec 文件重写工具

## 功能说明

本技能用于根据 GifMaker.spec 的配置逻辑，重写本项目的 .spec 文件，确保生成的可执行文件具有以下特性：

1. **图标显示**：在程序标题栏和任务栏正常显示应用图标
2. **配置文件读取**：程序运行后能准确识别并读取同级目录下的配置文件
3. **依赖管理**：正确收集所有必要的依赖文件和模块
4. **优化打包**：排除不必要的模块以减小可执行文件体积

## 使用场景

当您需要：
- 重新生成或更新项目的 .spec 文件配置
- 确保打包后的可执行文件能正确显示图标
- 确保打包后的程序能正确读取配置文件
- 优化打包过程和结果

## 实现原理

1. **参考 GifMaker.spec 的配置结构**：
   - 使用 `sys.argv[0]` 获取 spec 文件路径，确保在不同环境下都能正确定位
   - 自动收集所有必要的依赖文件和模块
   - 对 DLL 文件进行去重处理，避免重复打包
   - 正确配置图标路径和程序属性

2. **适配 DocumentSplitter 项目**：
   - 调整主程序入口文件为 `DocumentSplitter.py`
   - 包含项目特定的目录和模块
   - 添加项目所需的隐式导入
   - 配置正确的图标文件路径

3. **配置文件读取支持**：
   - 确保打包配置支持从同级目录读取配置文件
   - 提供配置文件包含的示例代码

## 示例用法

当您需要更新 .spec 文件时，可使用本技能生成新的配置文件，替换现有的 `DocumentSplitter.spec` 文件。

### 生成的 .spec 文件特性

1. **图标配置**：
   - 自动定位 `icons/DocumentSplitter.png` 作为程序图标
   - 确保在标题栏和任务栏正确显示

2. **配置文件支持**：
   - 程序运行时能识别同级目录下的配置文件
   - 提供配置文件包含的示例代码

3. **依赖管理**：
   - 自动收集所有必要的依赖模块
   - 排除不必要的模块以减小体积

4. **打包优化**：
   - 使用 UPX 压缩可执行文件
   - 正确处理 DLL 文件依赖

## 注意事项

- 运行本技能前，请确保项目中存在 `icons/DocumentSplitter.png` 图标文件
- 生成的 .spec 文件需要与 `DocumentSplitter.py` 在同一目录下
- 如需包含配置文件，请在生成的 .spec 文件中取消相关注释
